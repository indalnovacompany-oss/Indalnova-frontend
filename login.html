<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Indalnova | Login & Signup</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      display:flex; justify-content:center; align-items:center;
      min-height:100vh; background:#f5f5f5;
      font-family: 'Poppins', sans-serif;
    }
    .container {
      display:flex; width:90%; max-width:950px;
      background:#fff; border-radius:16px;
      overflow:hidden; box-shadow:0 8px 25px rgba(0,0,0,0.15);
    }
    .image-section { flex:1; background:url("Assets/bg.png") center/cover no-repeat; min-height:400px; }
    .form-section { flex:1; padding:2rem; display:flex; flex-direction:column; justify-content:center; }
    .form-section h2 { font-size:1.8rem; color:#333; margin-bottom:0.5rem; }
    .form-section p { margin-bottom:1.5rem; color:#555; }
    .form-group { margin-bottom:1rem; }
    .form-group input {
      width:100%; padding:0.8rem; border:1px solid #ccc; border-radius:8px;
      font-size:1rem; outline:none; transition:border 0.3s;
    }
    .form-group input:focus { border-color:#d4a055; }
    .forgot { text-align:right; margin-bottom:1rem; font-size:0.9rem; cursor:pointer; }
    .btn { width:100%; padding:0.9rem; background:brown; color:#fff; border:none; border-radius:8px; font-size:1rem; cursor:pointer; font-weight:bold; transition:background 0.3s; }
    .btn:hover { background:darkred; }
    .toggle-text { text-align:center; margin-top:1.2rem; font-size:0.95rem; }
    .toggle-text span { color:brown; cursor:pointer; font-weight:bold; }
    @media(max-width:768px){ .container{flex-direction:column;} .image-section{height:250px;} }

    /* Loader */
    #loadingOverlay {
      display:none; position:fixed; top:0; left:0; width:100%; height:100%;
      background: rgba(255,255,255,0.7); backdrop-filter: blur(2px);
      z-index:9999; justify-content:center; align-items:center;
    }
    #loadingOverlay div {
      border:6px solid #f3f3f3; border-top:6px solid brown;
      border-radius:50%; width:50px; height:50px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
  </style>
</head>
<body>
  <div class="container">
    <div class="image-section"></div>
    <div class="form-section">
      <!-- Login Form -->
      <div id="login-form">
        <h2>Welcome Back <span style="color:brown;">INDALNOVA</span></h2>
        <p>Login to explore.</p>
        <form id="loginForm">
          <div class="form-group">
            <input type="email" id="login-email" placeholder="Email" required/>
          </div>
          <div class="form-group">
            <input type="password" id="login-password" placeholder="Password" required/>
          </div>
          <div class="forgot" onclick="forgotPassword()">Forgot Password?</div>
          <button type="submit" class="btn">Login</button>
        </form>
        <p class="toggle-text">New here? <span onclick="toggleForms()">Create Account</span></p>
      </div>

      <!-- Signup Form -->
      <div id="signup-form" style="display:none;">
        <h2>Create your <span style="color:brown;">INDALNOVA</span> Account</h2>
        <p>Join us and enjoy exclusive offers.</p>
        <form id="signupForm">
          <div class="form-group"><input type="text" id="signup-name" placeholder="Full Name" required/></div>
          <div class="form-group"><input type="email" id="signup-email" placeholder="Email" required/></div>
          <div class="form-group"><input type="text" id="signup-phone" placeholder="Phone Number" required/></div>
          <div class="form-group"><input type="password" id="signup-password" placeholder="Create Password" required/></div>
          <button type="submit" class="btn">Sign Up</button>
        </form>
        <p class="toggle-text">Already have an account? <span onclick="toggleForms()">Login</span></p>
      </div>
    </div>
  </div>

  <!-- Loader Overlay -->
  <div id="loadingOverlay"><div></div></div>
<script>
// login.js
const loginForm = document.getElementById("loginForm");
const signupForm = document.getElementById("signupForm");
const loadingOverlay = document.getElementById("loadingOverlay");

function showLoader() { loadingOverlay.style.display = "flex"; }
function hideLoader() { loadingOverlay.style.display = "none"; }

function toggleForms() {
  const loginDiv = document.getElementById("login-form");
  const signupDiv = document.getElementById("signup-form");
  if (loginDiv.style.display === "none") {
    loginDiv.style.display = "block";
    signupDiv.style.display = "none";
  } else {
    loginDiv.style.display = "none";
    signupDiv.style.display = "block";
  }
}

function forgotPassword() {
  const email = prompt("Enter your registered email:");
  if (email) alert("Password reset link sent to " + email);
}

// ===== LOGIN =====
loginForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  showLoader();
  const email = document.getElementById("login-email").value.trim();
  const password = document.getElementById("login-password").value;

  try {
    const res = await fetch("/api/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });
    const data = await res.json();
    hideLoader();
    if (data.success) {
      localStorage.setItem("isLoggedIn", "true");
      localStorage.setItem("currentUser", email);
      alert("Login successful!");
      window.location.href = "index.html";
    } else {
      alert(data.message);
    }
  } catch (err) {
    hideLoader();
    console.error(err);
    alert("Server error, try again later");
  }
});

// ===== SIGNUP =====
signupForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  showLoader();
  const name = document.getElementById("signup-name").value.trim();
  const email = document.getElementById("signup-email").value.trim();
  const phone = document.getElementById("signup-phone").value.trim();
  const password = document.getElementById("signup-password").value;

  try {
    const res = await fetch("/api/signup", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, email, phone, password })
    });
    const data = await res.json();
    hideLoader();
    if (data.success) {
      alert("Signup successful! Please login.");
      toggleForms();
    } else {
      alert(data.message);
    }
  } catch (err) {
    hideLoader();
    console.error(err);
    alert("Server error, try again later");
  }
});

// Redirect if already logged in
if (localStorage.getItem("isLoggedIn") === "true") {
  window.location.href = "index.html";
}
</script>

</body>
</html>
